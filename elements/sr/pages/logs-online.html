<!--
`sr-pages-logs-online` provides the online version of the logs page. The logs
page allows you to see the current and previous log(s).

Example:

    <sr-core-page online="sr-pages-logs-online"></sr-core-page>

@group SR Pages Elements
@element sr-pages-logs-online
-->

<link rel="import" href="/bower_components/polymer/polymer.html" />
<link rel="import" href="../logs/index.html" />
<link rel="import" href="../ui/index.html" />
<link rel="import" href="../wamp/index.html" />

<polymer-element name="sr-pages-logs-online">
    <template>
        <style>
            :host {
                flex: 1 1 auto;
                display: flex;
                flex-direction: column;
            }

            sr-logs-logs {
                margin: 10px;
            }
        </style>

        <sr-ui-toolbar>
            <h1 flex>View Robot Logs</h1>
            <select id="logSelection" on-change="{{ handleLogSelectionChanged }}">
                <optgroup label="Current Logs" id="currentLogs">
                </optgroup>
                <optgroup label="Previous Logs" id="previousLogs">
                </optgroup>
            </select>
            <button id="btnBottom" on-click="{{ handleJumpToBottom }}">Jump to bottom</button>
        </sr-ui-toolbar>

        <sr-logs-logs id="logs" on-add="{{ handleAddLog }}"></sr-logs-logs>
    </template>

    <script>
        Polymer("sr-pages-logs-online", {
            handleJumpToBottom: function() {
                this.$.logs.currentLog.scrollToBottom();
            },
            handleAddLog: function(e) {
                var optgroup;
                var option = document.createElement("option");

                if (e.detail.type === "current") {
                    optgroup = this.$.currentLogs;
                    option.textContent = "Current";
                } else if (e.detail.type === "previous") {
                    optgroup = this.$.previousLogs;
                    option.textContent = "#" + e.detail.index;
                }

                option.value = e.detail.id;

                optgroup.appendChild(option);
            },
            handleLogSelectionChanged: function(e) {
                this.$.logs.changeTo(e.target.value);
            }
        });
    </script>
</polymer-element>
