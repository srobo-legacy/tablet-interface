<!--
`sr-pages-logs` provides a page which allows the user to see the current log
and also view any available old logs.

Example:

    <sr-core-page
        online="sr-pages-logs"
        offline="sr-pages-logs"></sr-core-page>

@group SR Pages Elements
@element sr-pages-logs
-->

<link rel="import" href="/bower_components/polymer/polymer.html" />
<link rel="import" href="../logs/index.html" />
<link rel="import" href="../ui/index.html" />
<link rel="import" href="../wamp/index.html" />

<polymer-element name="sr-pages-logs">
    <template>
        <style>
            :host {
                flex: 1 1 auto;
                display: flex;
                flex-direction: column;
            }

            sr-logs-logs {
                margin: 10px;
            }
        </style>

        <sr-ui-toolbar>
            <h1 flex>View Robot Logs</h1>
            <select id="logSelection" on-change="{{ handleLogSelectionChanged }}">
                <optgroup label="Current Logs" id="currentLogs"></optgroup>
                <optgroup label="Old Logs" id="oldLogs"></optgroup>
            </select>
            <button id="btnBottom" on-click="{{ handleJumpToBottom }}">Jump to bottom</button>
        </sr-ui-toolbar>

        <sr-logs-logs
            id="logs"
            on-add="{{ handleAddLog }}"
            on-remove="{{ handleRemoveLog }}"></sr-logs-logs>
    </template>

    <script>
        Polymer("sr-pages-logs", {
            handleJumpToBottom: function() {
                this.$.logs.currentLog.scrollToBottom();
            },
            handleAddLog: function(e) {
                var optgroup;
                var option = document.createElement("option");

                if (e.detail.type === "current") {
                    optgroup = this.$.currentLogs;
                } else if (e.detail.type === "old") {
                    optgroup = this.$.oldLogs;
                }

                option.textContent = e.detail.title;
                option.value = e.detail.name;

                optgroup.appendChild(option);
            },
            handleRemoveLog: function(e) {
                var option = this.$.logSelection.querySelector("[value=" + e.detail.id + "]");
                option.parentNode.removeChild(option);
            },
            handleLogSelectionChanged: function(e) {
                this.$.logs.changeTo(e.target.value);
            }
        });
    </script>
</polymer-element>
