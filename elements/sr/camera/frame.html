<!--
`sr-camera-frame` provides a container for a single frame from the camera.

Example:

    <sr-camera-frame></sr-camera-frame>

@group SR Camera Elements
@element sr-camera-frame
-->

<link rel="import" href="/bower_components/polymer/polymer.html" />

<polymer-element name="sr-camera-frame">
    <template>
        <style>
            :host {
                display: flex;
            }

            #paper {
                flex: 1 1 auto;
                display: flex;
            }

            #paper svg {
                flex: 1 1 auto;
            }
        </style>

        <div id="paper"></div>
    </template>

    <script src="raphael-min.js"></script>

    <script>
        Polymer("sr-camera-frame", {
            domReady: function() {
                this.paper = Raphael(this.$.paper);

                // Raphael.js insists on having absolute width and height
                // values. We need to remove them so the `svg` element fits
                // into the element whatever size it is.
                var svg = this.shadowRoot.querySelector("#paper svg");
                svg.removeAttribute("width");
                svg.removeAttribute("height");
            },
            setImage: function(src, markers) {
                this.paper.clear();

                var img = document.createElement("img");
                img.src = src;
                img.onload = function() {
                    this.paper.image(img.src, 0, 0, img.width, img.height);

                    markers.forEach(function(marker) {
                        this.paper.rect(marker.x, marker.y, marker.width,
                                        marker.height, 2);
                    }.bind(this));
                }.bind(this);
            }
        });
    </script>
</polymer-element>
