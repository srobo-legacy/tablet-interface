<!--
`sr-wamp-status-indicator` provides a small element which contains the WAMP
connection status.

Example:

    <sr-wamp-status-indicator></sr-wamp-status-indicator>

@group SR WAMP Elements
@element sr-wamp-status-indicator
-->

<link rel="import" href="/bower_components/polymer/polymer.html" />
<link rel="import" href="core.html" />

<dom-module id="sr-wamp-status-indicator">
  <template>
      <link rel="import" type="css" href="/bower_components/components-font-awesome/css/font-awesome.css" />

      <style>
        :host {
          display: block;
          padding: 4px 8px;
          background: black;
          color: white;
          opacity: 0.3;
          border-top-left-radius: 3px;
        }

        p {
          margin: 0;
        }

        .fa {
          vertical-align: middle;
        }
      </style>

      <sr-wamp-core id="wamp" on-open="{{ handleOpen }}" on-close="{{ handleClose }}"></sr-wamp-core>

      <p><span class="fa fa-thumbs-o-{{ $.wamp.connected ? 'up' : 'down' }} fa-fw"></span> {{ $.wamp.connected ? 'Online' : 'Offline' }}</p>
  </template>

  <script>
    Polymer({
      is: 'sr-wamp-status-indicator',

      handleOpen: function() {
        this.timeout = setTimeout(function() {
          this.style.display = "none";
          this.timeout = undefined;
        }.bind(this), 5000);
      },
      handleClose: function() {
        if (this.timeout !== undefined) {
          clearTimeout(this.timeout);
        }
        this.style.display = "block";
      }
    });
  </script>
</dom-module>
